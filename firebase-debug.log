[debug] [2025-12-29T07:51:38.158Z] ----------------------------------------------------------------------
[debug] [2025-12-29T07:51:38.160Z] Command:       /opt/homebrew/Cellar/node@20/20.18.3/bin/node /Users/chebrooks/Library/pnpm/global/5/.pnpm/firebase-tools@14.12.1_@types+node@22.17.0_encoding@0.1.13/node_modules/firebase-tools/lib/bin/firebase.js deploy --only firestore:rules --project backbone-logic --debug --non-interactive
[debug] [2025-12-29T07:51:38.160Z] CLI Version:   14.12.1
[debug] [2025-12-29T07:51:38.160Z] Platform:      darwin
[debug] [2025-12-29T07:51:38.160Z] Node Version:  v20.18.3
[debug] [2025-12-29T07:51:38.160Z] Time:          Sun Dec 28 2025 23:51:38 GMT-0800 (Pacific Standard Time)
[debug] [2025-12-29T07:51:38.160Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-12-29T07:51:38.236Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-12-29T07:51:38.237Z] > authorizing via signed-in user (chebacca@gmail.com)
[debug] [2025-12-29T07:51:38.237Z] [iam] checking project backbone-logic for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-12-29T07:51:38.237Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:38.237Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:38.238Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/backbone-logic:testIamPermissions [none]
[debug] [2025-12-29T07:51:38.238Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/backbone-logic:testIamPermissions x-goog-quota-user=projects/backbone-logic
[debug] [2025-12-29T07:51:38.238Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/backbone-logic:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-12-29T07:51:38.809Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/backbone-logic:testIamPermissions 200
[debug] [2025-12-29T07:51:38.809Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/backbone-logic:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'backbone-logic'...
[info] 
[info] i  deploying firestore 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-12-29T07:51:38.813Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:38.813Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:38.815Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic:test [none]
[debug] [2025-12-29T07:51:38.815Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic:test [omitted]
[debug] [2025-12-29T07:51:40.644Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic:test 200
[debug] [2025-12-29T07:51:40.644Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic:test {"issues":[{"sourcePosition":{"fileName":"firestore.rules","line":30,"column":14,"currentOffset":973,"endOffset":982},"description":"Unused function: hasOrgRole.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":71,"column":14,"currentOffset":2801,"endOffset":2818},"description":"Unused function: hasCallSheetAccess.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":79,"column":14,"currentOffset":3194,"endOffset":3209},"description":"Unused function: hasWalletAddress.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":91,"column":14,"currentOffset":3565,"endOffset":3584},"description":"Unused function: verifiedByUserWallet.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":96,"column":14,"currentOffset":3861,"endOffset":3876},"description":"Unused function: isStandaloneUser.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":99,"column":14,"currentOffset":3983,"endOffset":3999},"description":"Unused function: hasPageReadAccess.","severity":"WARNING"}]}
[warn] ⚠  [W] 30:14 - Unused function: hasOrgRole. 
[warn] ⚠  [W] 71:14 - Unused function: hasCallSheetAccess. 
[warn] ⚠  [W] 79:14 - Unused function: hasWalletAddress. 
[warn] ⚠  [W] 91:14 - Unused function: verifiedByUserWallet. 
[warn] ⚠  [W] 96:14 - Unused function: isStandaloneUser. 
[warn] ⚠  [W] 99:14 - Unused function: hasPageReadAccess. 
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-12-29T07:51:40.645Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:40.645Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:40.645Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/backbone-logic/databases/(default) [none]
[debug] [2025-12-29T07:51:40.992Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/backbone-logic/databases/(default) 200
[debug] [2025-12-29T07:51:40.992Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/backbone-logic/databases/(default) {"name":"projects/backbone-logic/databases/(default)","uid":"99cea2c9-8125-4628-8704-4fff87456c9f","createTime":"2025-08-09T07:00:46.665025Z","updateTime":"2025-08-09T07:00:46.665025Z","locationId":"nam5","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"604800s","earliestVersionTime":"2025-12-22T07:52:00Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"s","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_ENABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":false,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IPr84Zuo4pEDMMbm7L+Hm48D"}
[debug] [2025-12-29T07:51:40.993Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:40.993Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:40.993Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases pageSize=10&pageToken=
[debug] [2025-12-29T07:51:41.332Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases 200
[debug] [2025-12-29T07:51:41.332Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases {"releases":[{"name":"projects/backbone-logic/releases/cloud.firestore","rulesetName":"projects/backbone-logic/rulesets/15a0daea-e273-4da9-ae9a-6001b42ca8b3","createTime":"2025-08-09T17:14:12.861084Z","updateTime":"2025-12-23T21:02:33.909270Z"},{"name":"projects/backbone-logic/releases/firebase.storage/backbone-logic.firebasestorage.app","rulesetName":"projects/backbone-logic/rulesets/3b2afedb-a085-47b4-9c0b-a4437ec927e1","createTime":"2025-08-09T17:17:30.620153Z","updateTime":"2025-12-26T01:46:04.150195Z"}]}
[debug] [2025-12-29T07:51:41.340Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:41.340Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:41.340Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets/15a0daea-e273-4da9-ae9a-6001b42ca8b3 [none]
[debug] [2025-12-29T07:51:41.452Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets/15a0daea-e273-4da9-ae9a-6001b42ca8b3 200
[debug] [2025-12-29T07:51:41.452Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets/15a0daea-e273-4da9-ae9a-6001b42ca8b3 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-12-29T07:51:41.452Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:41.452Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:41.453Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets [none]
[debug] [2025-12-29T07:51:41.453Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets [omitted]
[debug] [2025-12-29T07:51:44.269Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets 200
[debug] [2025-12-29T07:51:44.271Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/rulesets {"name":"projects/backbone-logic/rulesets/c69dfbd8-6a6c-4373-9408-ca7092e28385","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{document=**} {\n      allow read, write: if request.auth != null;\n    }\n    \n    function isAuthenticated() {\n      return request.auth != null;\n    }\n    function getUserClaims() {\n      return request.auth.token;\n    }\n    function getOrganizationId() {\n      return getUserClaims().get('organizationId', '');\n    }\n    function belongsToOrganization(organizationId) {\n      return getOrganizationId() == organizationId || \n             organizationId in getUserClaims().get('allowedOrganizations', []);\n    }\n    function belongsToOrganizationWithDocCheck(organizationId) {\n      return belongsToOrganization(organizationId);\n    }\n    function hasRole(role) {\n      return isAuthenticated() && getUserClaims().get('role', '') == role;\n    }\n    function hasAnyRole(roles) {\n      return isAuthenticated() && getUserClaims().get('role', '') in roles;\n    }\n    function hasOrgRole(role) {\n      return isAuthenticated() && (getUserClaims().get('role', '') == role || getUserClaims().get('teamMemberRole', '') == role);\n    }\n    function hasAnyOrgRole(roles) {\n      return isAuthenticated() && (getUserClaims().get('role', '') in roles || getUserClaims().get('teamMemberRole', '') in roles);\n    }\n    function isOwnerOrAdmin() {\n      return isAuthenticated() && (\n        getUserClaims().get('isOwnerOrAdmin', false) ||\n        hasAnyRole(['OWNER', 'ADMIN', 'SUPERADMIN', 'SUPER_ADMIN'])\n      );\n    }\n    function isOwner(userId) {\n      return isAuthenticated() && request.auth.uid == userId;\n    }\n    function canAccessProject(projectId) {\n      return isAuthenticated() && (\n        projectId in getUserClaims().get('projectAssignments', {}) ||\n        belongsToOrganization(get(/databases/$(database)/documents/projects/$(projectId)).data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    function canModifyProject(projectId) {\n      return isAuthenticated() && (\n        (projectId in getUserClaims().get('projectAssignments', {}) &&\n         getUserClaims().get('projectAssignments', {})[projectId].get('baseRole', '') in ['ADMIN', 'DO_ER']) ||\n        (belongsToOrganization(get(/databases/$(database)/documents/projects/$(projectId)).data.organizationId) && isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    function hasMinimumHierarchy(minLevel) {\n      return isAuthenticated() && (\n        getUserClaims().get('effectiveHierarchy', 0) >= minLevel ||\n        getUserClaims().get('hierarchy', 0) >= minLevel\n      );\n    }\n    function hasEDLConverterAccess() {\n      return isAuthenticated() && getUserClaims().get('isEDLConverter', false);\n    }\n    function hasCallSheetAccess() {\n      return isAuthenticated() && getUserClaims().get('isCallSheetUser', false);\n    }\n    function getWalletAddresses() {\n      let addresses = getUserClaims().get('walletAddresses', []);\n      return addresses.size() > 0 ? addresses : \n             (getUserClaims().get('walletAddress', '') != '' ? [getUserClaims().get('walletAddress', '')] : []);\n    }\n    function hasWalletAddress(address) {\n      return isAuthenticated() && address != '' && (\n        getWalletAddresses().hasAny([address.lower()]) || \n        getWalletAddresses().hasAny([address])\n      );\n    }\n    function canVerifyBlockchain() {\n      return isAuthenticated() && (\n        getWalletAddresses().size() > 0 ||\n        isOwnerOrAdmin()\n      );\n    }\n    function verifiedByUserWallet(documentData) {\n      return isAuthenticated() && \n             documentData.get('blockchainMetadata', {}).get('verifiedBy', '') != '' &&\n             getWalletAddresses().hasAny([documentData.get('blockchainMetadata', {}).get('verifiedBy', '').lower()]);\n    }\n    function isStandaloneUser() {\n      return isAuthenticated() && getUserClaims().get('isStandaloneUser', false);\n    }\n    function hasPageReadAccess(pageId) {\n      return isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        getUserClaims().get('pagePermissions', {}).get('page:' + pageId + ':read', false) ||\n        getUserClaims().get('page:' + pageId + ':read', false)\n      );\n    }\n    function hasPageWriteAccess(pageId) {\n      return isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        getUserClaims().get('page:' + pageId + ':write', false) ||\n        (getUserClaims().get('pagePermissions', {}) != null && \n         getUserClaims().get('pagePermissions', {}).get(pageId, {}) != null &&\n         getUserClaims().get('pagePermissions', {}).get(pageId, {}).get('write', false))\n      );\n    }\n    function hasClipShowProAccess() {\n      return isAuthenticated() && (\n        getUserClaims().get('hasClipShowProAccess', false) ||\n        isOwnerOrAdmin()\n      );\n    }\n    function hasCueSheetAccess() {\n      return isAuthenticated() && (\n        getUserClaims().get('hasCueSheetAccess', false) ||\n        isOwnerOrAdmin()\n      );\n    }\n    function hasParserBrainAccess() {\n      return isAuthenticated() && (\n        getUserClaims().get('parserBrainAccess', false) ||\n        isOwnerOrAdmin() ||\n        'PARSER_BRAIN' in getUserClaims().get('permissions', [])\n      );\n    }\n    function hasIndexedFilesAccess() {\n      return hasClipShowProAccess() || hasCueSheetAccess();\n    }\n    function isLicensingSpecialist() {\n      return isAuthenticated() && (\n        getUserClaims().get('role', '') == 'LICENSING_SPECIALIST' ||\n        getUserClaims().get('isLicensingSpecialist', false) ||\n        'licensing_specialist' in getUserClaims().get('permissions', [])\n      );\n    }\n    function canAccessLicensingData(organizationId) {\n      return isAuthenticated() && (\n        (isLicensingSpecialist() && belongsToOrganization(organizationId)) ||\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(organizationId))\n      );\n    }\n    function canModifyLicensingData(organizationId) {\n      return isAuthenticated() && (\n        (isLicensingSpecialist() && belongsToOrganization(organizationId)) ||\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(organizationId) && \n         hasAnyRole(['ADMIN', 'SUPERADMIN', 'OWNER'])) ||\n        (belongsToOrganization(organizationId) && (\n          hasPageWriteAccess('clearance') ||\n          hasPageWriteAccess('pitching')\n        ))\n      );\n    }\n    match /roleSyncEvents/{eventId} {\n      allow read: if isAuthenticated();\n      allow write: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n    }\n    match /dataSyncEvents/{eventId} {\n      allow read: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (resource.data != null && resource.data.userId == request.auth.uid)\n      );\n      allow create: if isAuthenticated() && \n        request.resource.data.userId != null &&\n        (request.resource.data.userId == request.auth.uid || isOwnerOrAdmin());\n      allow update, delete: if isAuthenticated() && \n        resource.data != null &&\n        (resource.data.userId == request.auth.uid || isOwnerOrAdmin());\n    }\n    match /projectAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        request.auth.uid == resource.data.userId ||\n        canAccessProject(resource.data.projectId)\n      );\n      allow write: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n    }\n    match /users/{userId} {\n      allow read: if isAuthenticated();\n      allow write: if isAuthenticated() && request.auth.uid == userId;\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated() && (request.auth.uid == userId || isOwnerOrAdmin());\n    }\n    match /organizations/{orgId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(orgId) ||\n        belongsToOrganizationWithDocCheck(orgId) ||\n        (exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&\n         get(/databases/$(database)/documents/users/$(request.auth.uid)).data.organizationId == orgId) ||\n        isAuthenticated()\n      );\n      allow write: if isAuthenticated() && belongsToOrganization(orgId) && isOwnerOrAdmin();\n      allow create: if isAuthenticated() && isOwnerOrAdmin();\n      allow update: if isAuthenticated() && belongsToOrganization(orgId) && isOwnerOrAdmin();\n      match /callsheet-projects/{projectId} {\n        allow read: if isAuthenticated() && (\n          belongsToOrganization(orgId) ||\n          resource.data.ownerId == request.auth.uid ||\n          request.auth.uid == resource.data.userId\n        );\n        allow create: if isAuthenticated() && (\n          belongsToOrganization(orgId) ||\n          request.resource.data.ownerId == request.auth.uid ||\n          request.resource.data.userId == request.auth.uid\n        );\n        allow update: if isAuthenticated() && (\n          (belongsToOrganization(orgId) && isOwnerOrAdmin()) ||\n          resource.data.ownerId == request.auth.uid ||\n          request.auth.uid == resource.data.userId\n        );\n        allow delete: if isAuthenticated() && (\n          (belongsToOrganization(orgId) && isOwnerOrAdmin()) ||\n          resource.data.ownerId == request.auth.uid ||\n          request.auth.uid == resource.data.userId\n        );\n      }\n      match /nleSourceFolders/{folderId} {\n        allow read: if isAuthenticated() && (\n          (resource.data == null && (belongsToOrganization(orgId) || hasClipShowProAccess())) ||\n          (resource.data != null && (belongsToOrganization(orgId) || hasClipShowProAccess()))\n        );\n        allow create: if isAuthenticated() && (\n          belongsToOrganization(orgId) && isOwnerOrAdmin()\n        );\n        allow update: if isAuthenticated() && (\n          belongsToOrganization(orgId) && isOwnerOrAdmin()\n        );\n        allow delete: if isAuthenticated() && (\n          belongsToOrganization(orgId) && isOwnerOrAdmin()\n        );\n        match /files/{fileId} {\n          allow read, write, create: if isAuthenticated() && \n            belongsToOrganization(orgId);\n        }\n      }\n    }\n    match /teamMembers/{memberId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        (request.auth.uid == resource.data.userId && \n         belongsToOrganization(resource.data.organizationId)) ||\n        (isOwnerOrAdmin() && (\n          belongsToOrganization(resource.data.organizationId) ||\n          (exists(/databases/$(database)/documents/teamMembers/$(request.auth.uid)) &&\n           get(/databases/$(database)/documents/teamMembers/$(request.auth.uid)).data.organizationId == resource.data.organizationId) ||\n           getUserClaims().get('role', '') in ['OWNER', 'ADMIN', 'SUPERADMIN', 'SUPER_ADMIN']\n        ))\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /projectTeamMembers/{assignmentId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          canModifyProject(resource.data.projectId) ||\n          isOwnerOrAdmin()\n        )\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /project_team_members/{assignmentId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          canModifyProject(resource.data.projectId) ||\n          isOwnerOrAdmin()\n        )\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /project_participants/{participantId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          canModifyProject(resource.data.projectId) ||\n          isOwnerOrAdmin()\n        )\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /project_datasets/{linkId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canAccessProject(resource.data.projectId) ||\n        hasAnyRole(['ADMIN', 'SUPERADMIN', 'OWNER'])\n      );\n      allow write: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n      allow create: if isAuthenticated() && belongsToOrganization(request.resource.data.organizationId) && isOwnerOrAdmin();\n      allow update: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /datasets/{datasetId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == resource.data.ownerId ||\n        belongsToOrganization(resource.data.organizationId) ||\n        canAccessProject(resource.data.projectId) ||\n        hasAnyRole(['ADMIN', 'SUPERADMIN', 'OWNER'])\n      );\n      allow write: if isAuthenticated() && (\n        request.auth.uid == resource.data.ownerId ||\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin())\n      );\n      allow create: if isAuthenticated() && belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() && (\n        request.auth.uid == resource.data.ownerId ||\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin())\n      );\n    }\n    match /projects/{projectId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() && \n                     resource.data != null &&\n                     canModifyProject(projectId);\n      allow delete: if isAuthenticated() && \n                     resource.data != null &&\n                     belongsToOrganization(resource.data.organizationId) && \n                     isOwnerOrAdmin();\n    }\n    match /folders/{folderId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && (\n        isOwnerOrAdmin() || resource.data.createdBy == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /projectFolderAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId)) ||\n        (resource.data == null && getOrganizationId() != '')\n      );\n      allow create: if isAuthenticated() && belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() && belongsToOrganization(resource.data.organizationId);\n      allow delete: if isAuthenticated() && belongsToOrganization(resource.data.organizationId);\n    }\n    match /sessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canAccessProject(resource.data.projectId) ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      ) && (\n        // ENFORCE: Sessions must have a projectId\n        request.resource.data.projectId is string &&\n        request.resource.data.projectId.size() > 0\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canModifyProject(resource.data.projectId) ||\n        isOwnerOrAdmin()\n      ) && (\n        // ENFORCE: Cannot remove projectId\n        request.resource.data.projectId is string &&\n        request.resource.data.projectId.size() > 0\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /timecards/{timecardId} {\n      allow read: if isOwner(resource.data.userId) || \n                     canAccessProject(resource.data.projectId);\n      allow create: if canAccessProject(request.resource.data.projectId);\n      allow update: if isOwner(resource.data.userId) || \n                       canModifyProject(resource.data.projectId);\n    }\n    match /timecardTemplates/{templateId} {\n      allow read: if belongsToOrganization(resource.data.organizationId);\n      allow create: if belongsToOrganization(request.resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow update: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow delete: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin']);\n    }\n    match /timecardAssignments/{assignmentId} {\n      allow read: if belongsToOrganization(resource.data.organizationId);\n      allow create: if belongsToOrganization(request.resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow update: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow delete: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin']);\n    }\n    match /timecardConfigurations/{configId} {\n      allow read: if belongsToOrganization(resource.data.organizationId);\n      allow create: if belongsToOrganization(request.resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow update: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin', 'manager']);\n      allow delete: if belongsToOrganization(resource.data.organizationId) && \n                       hasAnyOrgRole(['owner', 'admin']);\n    }\n    match /inventoryItems/{itemId} {\n      allow read: if canAccessProject(resource.data.projectId);\n      allow write: if canModifyProject(resource.data.projectId);\n    }\n    match /reports/{reportId} {\n      allow read: if canAccessProject(resource.data.projectId);\n      allow create: if canAccessProject(request.resource.data.projectId);\n      allow update: if isOwner(resource.data.userId) || \n                       canModifyProject(resource.data.projectId);\n    }\n    match /notifications/{notificationId} {\n      // Read: User can read their own notifications, or team members in same organization\n      allow read: if isAuthenticated() && (\n        isOwner(resource.data.userId) || \n        isOwnerOrAdmin() ||\n        (resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId))\n      );\n      \n      // Create: Anyone authenticated can create notifications (system can create for users)\n      allow create: if isAuthenticated() && (\n        request.resource.data.userId != null &&\n        request.resource.data.organizationId != null &&\n        request.resource.data.category != null &&\n        request.resource.data.title != null &&\n        request.resource.data.message != null\n      );\n      \n      // Update: User can update their own notifications, or admins\n      allow update: if isAuthenticated() && (\n        isOwner(resource.data.userId) || \n        isOwnerOrAdmin() ||\n        (resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId) &&\n         hasAnyOrgRole(['owner', 'admin']))\n      );\n      \n      // Delete: User can delete their own notifications, or admins\n      allow delete: if isAuthenticated() && (\n        isOwner(resource.data.userId) || \n        isOwnerOrAdmin() ||\n        (resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId) &&\n         hasAnyOrgRole(['owner', 'admin']))\n      );\n    }\n    match /notificationPreferences/{userId} {\n      allow read, write: if isAuthenticated() && request.auth.uid == userId;\n      allow create: if isAuthenticated() && request.auth.uid == userId;\n      allow update: if isAuthenticated() && request.auth.uid == userId;\n    }\n    match /userTableViews/{userId} {\n      allow read, write: if isAuthenticated() && request.auth.uid == userId;\n      allow create: if isAuthenticated() && request.auth.uid == userId;\n      allow update: if isAuthenticated() && request.auth.uid == userId;\n      allow delete: if isAuthenticated() && request.auth.uid == userId;\n    }\n    match /licenses/{licenseId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        (isAuthenticated() && resource.data.userId == request.auth.uid) ||\n        isAuthenticated()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) && \n        hasAnyOrgRole(['owner', 'admin']) ||\n        (isAuthenticated() && request.resource.data.userId == request.auth.uid)\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && \n        hasAnyOrgRole(['owner', 'admin']) ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && \n        hasAnyOrgRole(['owner', 'admin'])\n      );\n    }\n    match /subscriptions/{subscriptionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        belongsToOrganizationWithDocCheck(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        (get(/databases/$(database)/documents/users/$(request.auth.uid)).data.organizationId == resource.data.organizationId) ||\n        isAuthenticated()\n      );\n      allow create: if isAuthenticated() && (\n        (belongsToOrganization(request.resource.data.organizationId) && \n         hasAnyOrgRole(['owner', 'admin'])) ||\n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) && \n         hasAnyOrgRole(['owner', 'admin'])) ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && \n        hasAnyOrgRole(['owner', 'admin'])\n      );\n    }\n    match /standaloneLicenses/{licenseId} {\n      allow read: if isAuthenticated() && (\n        isAuthenticated() ||\n        resource.data.userId == request.auth.uid ||\n        hasAnyRole(['OWNER', 'ADMIN'])\n      );\n      allow create: if isAuthenticated() && (\n        isAuthenticated() && \n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && (\n        resource.data.userId == request.auth.uid ||\n        hasAnyRole(['OWNER', 'ADMIN'])\n      );\n      allow delete: if isAuthenticated() && (\n        resource.data.userId == request.auth.uid ||\n        hasAnyRole(['OWNER', 'ADMIN'])\n      );\n    }\n    match /invoices/{invoiceId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        resource.data.firebaseUid == request.auth.uid ||\n        isOwnerOrAdmin() ||\n        (isAuthenticated() && getOrganizationId() != '')\n      );\n      allow create: if isAuthenticated() && (\n        (belongsToOrganization(request.resource.data.organizationId) && isOwnerOrAdmin()) ||\n        request.resource.data.userId == request.auth.uid ||\n        request.resource.data.firebaseUid == request.auth.uid\n      );\n      allow update: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        resource.data.userId == request.auth.uid ||\n        resource.data.firebaseUid == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && \n        isOwnerOrAdmin()\n      );\n    }\n    match /payments/{paymentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        resource.data.firebaseUid == request.auth.uid ||\n        isOwnerOrAdmin() ||\n        (isAuthenticated() && getOrganizationId() != '')\n      );\n      allow create: if isAuthenticated() && (\n        (belongsToOrganization(request.resource.data.organizationId) && isOwnerOrAdmin()) ||\n        request.resource.data.userId == request.auth.uid ||\n        request.resource.data.firebaseUid == request.auth.uid\n      );\n      allow update: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        resource.data.userId == request.auth.uid ||\n        resource.data.firebaseUid == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && \n        isOwnerOrAdmin()\n      );\n    }\n    match /orgMembers/{memberId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        belongsToOrganization(resource.data.orgId) ||\n        request.auth.uid == resource.data.userId ||\n        request.auth.uid == resource.data.firebaseUid ||\n        isOwnerOrAdmin() ||\n        (isAuthenticated() && getOrganizationId() != '')\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        belongsToOrganization(request.resource.data.orgId) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        ((belongsToOrganization(resource.data.organizationId) ||\n          belongsToOrganization(resource.data.orgId)) && isOwnerOrAdmin()) ||\n        request.auth.uid == resource.data.userId ||\n        request.auth.uid == resource.data.firebaseUid\n      );\n      allow delete: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) ||\n         belongsToOrganization(resource.data.orgId)) && \n        isOwnerOrAdmin()\n      );\n    }\n    match /callsheetCallSheets/{callSheetId} {\n      allow read, write: if isAuthenticated();\n    }\n    match /callsheets/{callSheetId} {\n      allow read, write: if isAuthenticated() && belongsToOrganization(resource.data.organizationId);\n    }\n    match /callSheets/{callSheetId} {\n      allow read: if isAuthenticated();\n      allow write: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        request.auth.uid == resource.data.userId\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid\n      );\n    }\n    match /callsheetPersonnel/{personnelId} {\n      allow read, write: if isAuthenticated();\n    }\n    match /standalonePersonnel/{personnelId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        request.auth.uid == resource.data.userId\n      );\n      allow write: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        request.auth.uid == resource.data.userId\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid\n      );\n    }\n    match /callsheetTemplates/{templateId} {\n      allow read, write: if isAuthenticated();\n    }\n    match /callsheetPublishedCallSheets/{publishId} {\n      allow read, write: if isAuthenticated();\n    }\n    match /publishedCallSheets/{publishId} {\n      allow read: if true;\n      allow write: if isAuthenticated();\n    }\n    match /callsheetLinks/{linkId} {\n      allow read: if true; \n      allow write: if isAuthenticated();\n    }\n    match /callsheetDailyRecords/{recordId} {\n      allow read, write: if isAuthenticated();\n      allow create: if isAuthenticated();\n    }\n    match /dailyCallSheetRecords/{recordId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        (belongsToOrganization(request.resource.data.organizationId) &&\n         request.resource.data.userId == request.auth.uid) ||\n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) &&\n         resource.data.userId == request.auth.uid) ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        resource.data.userId == request.auth.uid\n      );\n    }\n    match /dailyCallSheets/{recordId} {\n      allow read, write: if isAuthenticated();\n    }\n    match /messageSessions/{sessionId} {\n      allow read: if isAuthenticated() \n        && belongsToOrganization(resource.data.organizationId)\n        && request.auth.uid in resource.data.participantIds;\n      allow read: if isAuthenticated() \n        && isOwnerOrAdmin()\n        && belongsToOrganization(resource.data.organizationId);\n      allow write: if isAuthenticated() \n        && belongsToOrganization(resource.data.organizationId)\n        && request.auth.uid in resource.data.participantIds;\n      allow create: if isAuthenticated() \n        && belongsToOrganization(request.resource.data.organizationId)\n        && request.auth.uid in request.resource.data.participantIds;\n    }\n    match /messages/{messageId} {\n      allow read: if isAuthenticated() \n        && resource.data != null\n        && belongsToOrganization(resource.data.organizationId);\n      allow update, delete: if isAuthenticated() \n        && resource.data != null\n        && belongsToOrganization(resource.data.organizationId)\n        && request.auth.uid == resource.data.senderId;\n      allow read, update, delete: if isAuthenticated() \n        && isOwnerOrAdmin()\n        && resource.data != null\n        && belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() \n        && request.resource.data.organizationId != null\n        && request.resource.data.messageSessionId != null\n        && request.auth.uid == request.resource.data.senderId\n        && (\n          belongsToOrganization(request.resource.data.organizationId) ||\n          (exists(/databases/$(database)/documents/messageSessions/$(request.resource.data.messageSessionId)) &&\n           request.auth.uid in get(/databases/$(database)/documents/messageSessions/$(request.resource.data.messageSessionId)).data.participantIds &&\n           belongsToOrganization(get(/databases/$(database)/documents/messageSessions/$(request.resource.data.messageSessionId)).data.organizationId))\n        );\n      allow create: if isAuthenticated() \n        && isOwnerOrAdmin()\n        && request.resource.data.organizationId != null\n        && belongsToOrganization(request.resource.data.organizationId);\n    }\n    match /guest_profiles/{id} {\n      allow read: if true; // Allow unauthenticated read for guest claiming\n    }\n    match /userSessions/{userId} {\n      allow read: if isAuthenticated() && request.auth.uid == userId;\n      allow write: if isAuthenticated() && request.auth.uid == userId;\n      allow create: if isAuthenticated() \n        && request.auth.uid == userId\n        && request.resource.data.userId == userId;\n      allow update: if isAuthenticated() \n        && request.auth.uid == userId\n        && resource.data.userId == userId;\n      allow delete: if isAuthenticated() && request.auth.uid == userId;\n    }\n    match /edlFiles/{fileId} {\n      allow read: if isAuthenticated() && hasEDLConverterAccess();\n      allow create: if isAuthenticated() && hasEDLConverterAccess();\n      allow update: if isAuthenticated() && hasEDLConverterAccess();\n      allow delete: if isAuthenticated() && hasEDLConverterAccess();\n    }\n    match /edlFileMetadata/{document} {\n      allow read: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow create: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n    }\n    match /edlFileChunks/{document} {\n      allow read: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow create: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n    }\n    match /edlProjects/{projectId} {\n      allow read: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow create: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        request.resource.data.userId == request.auth.uid\n      );\n      allow update: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n      allow delete: if isAuthenticated() && hasEDLConverterAccess() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        resource.data.userId == request.auth.uid\n      );\n    }\n    match /parsing-admin-users/{userId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin'])\n      );\n      allow write: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        isOwnerOrAdmin() ||\n        hasAnyOrgRole(['owner', 'admin'])\n      );\n    }\n    match /parsing-patterns/{patternId} {\n      allow read: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        isOwnerOrAdmin()\n      );\n      allow write: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        hasMinimumHierarchy(50) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /pattern-statistics/{statId} {\n      allow read: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        isOwnerOrAdmin()\n      );\n      allow write: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        hasMinimumHierarchy(50) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /pattern-submissions/{submissionId} {\n      allow read: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        isOwnerOrAdmin()\n      );\n      allow write: if isAuthenticated() && (\n        hasParserBrainAccess() ||\n        hasAnyOrgRole(['owner', 'admin']) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /knowledge_base/{docId} {\n      allow read: if isAuthenticated() && (\n        resource.data.organizationId == 'global' ||\n        belongsToOrganization(resource.data.organizationId) ||\n        isOwnerOrAdmin()\n      );\n      allow write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        hasAnyOrgRole(['owner', 'admin'])\n      );\n    }\n    match /workflowActions/{actionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin() ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /_system/{docId} {\n      allow read: if isAuthenticated();\n      allow write: if isAuthenticated() && (\n        hasAnyRole(['OWNER', 'ADMIN']) || \n        hasAnyOrgRole(['owner', 'admin']) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /_health/{docId} {\n      allow read: if isAuthenticated();\n      allow write: if isAuthenticated() && (\n        hasAnyRole(['OWNER', 'ADMIN']) || \n        hasAnyOrgRole(['owner', 'admin'])\n      );\n    }\n    match /projectData/{dataId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /mapLayouts/{mapLayoutId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /mapLocations/{mapLocationId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /mapData/{mapDataId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /pbmProjects/{projectId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /pbmSchedules/{scheduleId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /pbmPayscales/{payscaleId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /pbmDailyStatus/{statusId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /productionSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /user_timecards/{timecardId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /timecard_entries/{entryId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /timecard_approvals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.employeeId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.employeeId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /timecard_templates/{templateId} {\n      allow read: if isAuthenticated() && (\n        resource.data.isPublic == true ||\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /production_budgets/{budgetId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /budget_line_items/{lineItemId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n    }\n    match /budget_approvals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']) || resource.data.requestedBy == request.auth.uid) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.requestedBy == request.auth.uid || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /budget_templates/{templateId} {\n      allow read: if isAuthenticated() && (\n        resource.data.isPublic == true ||\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n    }\n    match /expenses/{expenseId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.submittedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.submittedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || \n         resource.data.submittedBy == request.auth.uid ||\n         hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || \n         resource.data.submittedBy == request.auth.uid ||\n         isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /expense_approvals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']) || \n         resource.data.requestedBy == request.auth.uid) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.requestedBy == request.auth.uid || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /purchase_orders/{poId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || \n         resource.data.requestedBy == request.auth.uid ||\n         hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || \n         resource.data.requestedBy == request.auth.uid ||\n         isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /invoices/{invoiceId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' ||\n         hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /po_approvals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.requestedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']) || \n         resource.data.requestedBy == request.auth.uid) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.requestedBy == request.auth.uid || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /payroll_batches/{batchId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' ||\n         hasAnyOrgRole(['ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.status == 'draft' || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /payroll_entries/{entryId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n    }\n    match /financial_reports/{reportId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.generatedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.generatedBy == request.auth.uid ||\n        getOrganizationId() == 'standalone' ||\n        (hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER']))\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.generatedBy == request.auth.uid ||\n         hasAnyOrgRole(['LINE_PRODUCER', 'ACCOUNTANT', 'ADMIN', 'OWNER'])) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) &&\n        (resource.data.generatedBy == request.auth.uid || isOwnerOrAdmin()) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /schedulerEvents/{eventId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /calendarEvents/{eventId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canAccessProject(resource.data.projectId) ||\n        resource.data.createdBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        canAccessProject(request.resource.data.projectId) ||\n        request.resource.data.createdBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canModifyProject(resource.data.projectId) ||\n        resource.data.createdBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canModifyProject(resource.data.projectId) ||\n        resource.data.createdBy == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /schedulerEventAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /notes/{noteId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.userId == request.auth.uid ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /mediaFiles/{mediaFileId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        resource.data.uploadedBy == request.auth.uid ||\n        isOwnerOrAdmin() ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        request.resource.data.uploadedBy == request.auth.uid ||\n        isOwnerOrAdmin() ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          resource.data.uploadedBy == request.auth.uid ||\n          isOwnerOrAdmin()\n        ) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          resource.data.uploadedBy == request.auth.uid ||\n          isOwnerOrAdmin()\n        ) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /clipShowPitches/{pitchId} {\n      allow read: if isAuthenticated() && (\n        getOrganizationId() != '' ||\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId)) ||\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId))\n      );\n      allow create: if isAuthenticated() && (\n        (request.resource.data != null && request.resource.data.organizationId != null && belongsToOrganization(request.resource.data.organizationId)) ||\n        (request.resource.data != null && request.resource.data.organizationId != null && canAccessLicensingData(request.resource.data.organizationId))\n      );\n      allow update: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId)) ||\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId))\n      );\n      allow delete: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin())\n      );\n    }\n    match /clipShowLicenses/{licenseId} {\n      allow read: if isAuthenticated() && (\n        hasClipShowProAccess() ||\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (resource.data == null && hasClipShowProAccess()) ||\n        isOwnerOrAdmin()\n      );\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId) ||\n                    (canAccessLicensingData(resource.data.organizationId) && \n                     canVerifyBlockchain() &&\n                     request.resource.data.diff(resource.data).affectedKeys().hasOnly(['blockchainMetadata', 'updatedAt']));\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /clipShowLicenseTemplates/{templateId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess()) ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        canAccessLicensingData(request.resource.data.organizationId) ||\n        (hasClipShowProAccess() && belongsToOrganization(request.resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess() && resource.data != null && belongsToOrganization(resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowSignedDocuments/{documentId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess()) ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        canAccessLicensingData(request.resource.data.organizationId) ||\n        (hasClipShowProAccess() && belongsToOrganization(request.resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess() && resource.data != null && belongsToOrganization(resource.data.organizationId)) ||\n        (canAccessLicensingData(resource.data.organizationId) && \n         canVerifyBlockchain() &&\n         request.resource.data.diff(resource.data).affectedKeys().hasOnly(['blockchainMetadata', 'updatedAt'])) ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowLicenseEmailHistory/{emailId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess()) ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        canAccessLicensingData(request.resource.data.organizationId) ||\n        (hasClipShowProAccess() && belongsToOrganization(request.resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId)) ||\n        (hasClipShowProAccess() && resource.data != null && belongsToOrganization(resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowStories/{storyId} {\n      allow read: if isAuthenticated() && (\n        request.auth.token.email == 'admin.clipshow@example.com' ||\n        (hasClipShowProAccess() && getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId)) ||\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (resource.data == null && hasClipShowProAccess() && getOrganizationId() != '')\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        canAccessLicensingData(request.resource.data.organizationId)\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        canModifyLicensingData(resource.data.organizationId)\n      );\n      allow delete: if isAuthenticated() && (\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        (canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin())\n      );\n      match /scriptVersions/{versionId} {\n        function getParentStory() {\n          return get(/databases/$(database)/documents/clipShowStories/$(storyId)).data;\n        }\n        allow read: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canAccessLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow create: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow update: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow delete: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) && isOwnerOrAdmin() ||\n            canModifyLicensingData(getParentStory().organizationId) && isOwnerOrAdmin()\n          )) ||\n          (hasClipShowProAccess() && isOwnerOrAdmin())\n        );\n      }\n      match /cellVersions/{coordinate} {\n        function getParentStory() {\n          return get(/databases/$(database)/documents/clipShowStories/$(storyId)).data;\n        }\n        allow read: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canAccessLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow create: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow update: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow delete: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n      }\n      match /inlineComments/{commentId} {\n        function getParentStorySafe() {\n          return exists(/databases/$(database)/documents/clipShowStories/$(storyId)) \n            ? get(/databases/$(database)/documents/clipShowStories/$(storyId)).data \n            : null;\n        }\n        allow read: if isAuthenticated() && (\n          (getParentStorySafe() != null && getParentStorySafe().organizationId != null && (\n            belongsToOrganization(getParentStorySafe().organizationId) ||\n            canAccessLicensingData(getParentStorySafe().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '') ||\n          isAuthenticated()\n        );\n        allow create: if isAuthenticated() && (\n          (getParentStorySafe() != null && getParentStorySafe().organizationId != null && (\n            belongsToOrganization(getParentStorySafe().organizationId) ||\n            canModifyLicensingData(getParentStorySafe().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '') ||\n          (isAuthenticated() && getOrganizationId() != '')\n        );\n        allow update: if isAuthenticated() && (\n          (resource.data.authorId == request.auth.uid) ||\n          (getParentStorySafe() != null && getParentStorySafe().organizationId != null && (\n            belongsToOrganization(getParentStorySafe().organizationId) ||\n            canModifyLicensingData(getParentStorySafe().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow delete: if isAuthenticated() && (\n          (resource.data.authorId == request.auth.uid) ||\n          (getParentStorySafe() != null && getParentStorySafe().organizationId != null && (\n            belongsToOrganization(getParentStorySafe().organizationId) ||\n            canModifyLicensingData(getParentStorySafe().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n      }\n      match /trackedChanges/{changeId} {\n        function getParentStory() {\n          return get(/databases/$(database)/documents/clipShowStories/$(storyId)).data;\n        }\n        allow read: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canAccessLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow create: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow update: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow delete: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n      }\n      match /revisionChecklist/{itemId} {\n        function getParentStory() {\n          return get(/databases/$(database)/documents/clipShowStories/$(storyId)).data;\n        }\n        allow read: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canAccessLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow create: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow update: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n        allow delete: if isAuthenticated() && (\n          (getParentStory() != null && getParentStory().organizationId != null && (\n            belongsToOrganization(getParentStory().organizationId) ||\n            canModifyLicensingData(getParentStory().organizationId)\n          )) ||\n          (hasClipShowProAccess() && getOrganizationId() != '')\n        );\n      }\n    }\n    match /clipShowShows/{showId} {\n      allow read: if isAuthenticated() && (\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (resource.data == null && hasClipShowProAccess() && getOrganizationId() != '')\n      );\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId);\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /trashcan/{trashcanId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && (\n          belongsToOrganization(resource.data.organizationId) ||\n          canAccessLicensingData(resource.data.organizationId)\n        )) ||\n        hasClipShowProAccess() ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        canModifyLicensingData(request.resource.data.organizationId) ||\n        (hasClipShowProAccess() && belongsToOrganization(request.resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && (\n          belongsToOrganization(resource.data.organizationId) ||\n          canModifyLicensingData(resource.data.organizationId)\n        )) ||\n        (hasClipShowProAccess() && resource.data != null && belongsToOrganization(resource.data.organizationId)) ||\n        isOwnerOrAdmin()\n      );\n      allow update: if false;\n    }\n    match /clipShowSeasons/{seasonId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId);\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId);\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /clipShowComments/{commentId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId);\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId) && (\n        resource.data.userId == request.auth.uid ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && (\n        resource.data.userId == request.auth.uid ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowDocuments/{documentId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId);\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId);\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /clipShowScriptTemplates/{templateId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId) && (\n        resource.data.isPublic == true ||\n        belongsToOrganization(resource.data.organizationId)\n      );\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId);\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /clipShowLicensingSpecialists/{specialistId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId);\n      allow create: if canAccessLicensingData(request.resource.data.organizationId) && isOwnerOrAdmin();\n      allow update: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n      allow delete: if canModifyLicensingData(resource.data.organizationId) && isOwnerOrAdmin();\n    }\n    match /clipShowContacts/{contactId} {\n      allow read: if isAuthenticated() && (\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && canAccessLicensingData(resource.data.organizationId)) ||\n        (resource.data == null && hasClipShowProAccess() && getOrganizationId() != '')\n      );\n      allow create: if canAccessLicensingData(request.resource.data.organizationId);\n      allow update: if canModifyLicensingData(resource.data.organizationId);\n      allow delete: if canModifyLicensingData(resource.data.organizationId);\n    }\n    match /clipShowNotes/{noteId} {\n      allow read: if isAuthenticated() && (\n        hasClipShowProAccess() ||\n        (resource.data == null) ||\n        (resource.data != null && resource.data.organizationId != null && (\n          (resource.data.userId == request.auth.uid) ||\n          canAccessLicensingData(resource.data.organizationId) ||\n          isOwnerOrAdmin()\n        ))\n      );\n      allow create: if isAuthenticated() && (\n        request.resource.data.userId == request.auth.uid && (\n          canAccessLicensingData(request.resource.data.organizationId) ||\n          (hasClipShowProAccess() && belongsToOrganization(request.resource.data.organizationId)) ||\n          (getOrganizationId() != '' && getOrganizationId() == request.resource.data.organizationId) ||\n          isOwnerOrAdmin()\n        )\n      );\n      allow update: if isAuthenticated() && (\n        canAccessLicensingData(resource.data.organizationId) && (\n          resource.data.userId == request.auth.uid ||\n          isOwnerOrAdmin()\n        )\n      );\n      allow delete: if isAuthenticated() && (\n        canAccessLicensingData(resource.data.organizationId) && (\n          resource.data.userId == request.auth.uid ||\n          isOwnerOrAdmin()\n        )\n      );\n    }\n    match /clipShowEpisodes/{episodeId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/clipShowEpisodes/{episodeId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /scriptApprovals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/scriptApprovals/{approvalId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /accessLogs/{logId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/accessLogs/{logId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /Editor/{editorId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /airtableBackupSchedules/{scheduleId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/airtableBackupSchedules/{scheduleId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /airtableRollbackLogs/{logId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/airtableRollbackLogs/{logId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /cloudIntegrations/{integrationId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/cloudIntegrations/{integrationId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /consentRecords/{consentId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/consentRecords/{consentId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.userId != null && \n         request.auth.uid == resource.data.userId) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /dataExports/{exportId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/dataExports/{exportId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.userId != null && \n         request.auth.uid == resource.data.userId) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /dataProcessingActivities/{activityId} {\n      allow read: if isOwnerOrAdmin();\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/dataProcessingActivities/{activityId} {\n      allow read: if isOwnerOrAdmin();\n    }\n    match /dataProcessingLogs/{logId} {\n      allow read: if isOwnerOrAdmin();\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/dataProcessingLogs/{logId} {\n      allow read: if isOwnerOrAdmin();\n    }\n    match /dataRetentionPolicies/{policyId} {\n      allow read: if isAuthenticated();\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/dataRetentionPolicies/{policyId} {\n      allow read: if isAuthenticated();\n    }\n    match /dataSubjectRequests/{requestId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/dataSubjectRequests/{requestId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.userId != null && \n         request.auth.uid == resource.data.userId) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /archivedData/{archiveId} {\n      allow read: if isOwnerOrAdmin();\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/archivedData/{archiveId} {\n      allow read: if isOwnerOrAdmin();\n    }\n    match /pitches/{pitchId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/pitches/{pitchId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /productionStories/{storyId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/productionStories/{storyId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /scriptSuggestions/{suggestionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/scriptSuggestions/{suggestionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowProjects/{projectId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        canAccessLicensingData(request.resource.data.organizationId)\n      );\n      allow update, delete: if isAuthenticated() && \n                               resource.data != null &&\n                               (canModifyLicensingData(resource.data.organizationId) || \n                                belongsToOrganization(resource.data.organizationId)) &&\n                               (isOwnerOrAdmin() || resource.data.createdBy == request.auth.uid);\n    }\n    match /clipShowFolders/{folderId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        canModifyLicensingData(request.resource.data.organizationId)\n      );\n      allow update: if isAuthenticated() && \n                     resource.data != null &&\n                     (belongsToOrganization(resource.data.organizationId) ||\n                      canModifyLicensingData(resource.data.organizationId)) && (\n                       isOwnerOrAdmin() || resource.data.createdBy == request.auth.uid\n                     );\n      allow delete: if isAuthenticated() && \n                     resource.data != null &&\n                     (belongsToOrganization(resource.data.organizationId) ||\n                      canModifyLicensingData(resource.data.organizationId)) &&\n                     (isOwnerOrAdmin() || resource.data.createdBy == request.auth.uid);\n    }\n    match /clipShowBudgetMetadata/{budgetId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId) && \n        canAccessProject(resource.data.projectId);\n      allow write: if canModifyLicensingData(request.resource.data.organizationId) && \n        canModifyProject(request.resource.data.projectId);\n    }\n    match /clipShowIndexedFiles/{fileId} {\n      allow read: if isAuthenticated() && (\n          isOwnerOrAdmin() ||\n        (hasIndexedFilesAccess()) ||\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId))\n      );\n      allow create, update: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) && (\n          isOwnerOrAdmin() ||\n          hasPageWriteAccess('indexed-files') ||\n          hasIndexedFilesAccess()\n        )\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && (\n          isOwnerOrAdmin() ||\n          hasPageWriteAccess('indexed-files') ||\n          hasClipShowProAccess()\n        )\n      );\n    }\n    match /clipShowParsedFiles/{fileId} {\n      allow read: if canAccessLicensingData(resource.data.organizationId) && \n        canAccessProject(resource.data.projectId);\n      allow write: if canModifyLicensingData(request.resource.data.organizationId) && \n        canModifyProject(request.resource.data.projectId);\n    }\n    match /firebaseStorageFiles/{fileId} {\n      allow read: if isAuthenticated() && (\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId))\n      );\n      allow create: if isAuthenticated() && \n        request.resource.data.organizationId != null &&\n        (belongsToOrganization(request.resource.data.organizationId) ||\n         (getOrganizationId() != '' && getOrganizationId() == request.resource.data.organizationId) ||\n         isOwnerOrAdmin());\n      allow update, delete: if isAuthenticated() && \n        resource.data != null &&\n        resource.data.organizationId != null &&\n        (belongsToOrganization(resource.data.organizationId) ||\n         isOwnerOrAdmin());\n    }\n    match /firebaseStorageFolders/{folderId} {\n      allow read: if isAuthenticated() && (\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId))\n      );\n      allow create: if isAuthenticated() && \n        request.resource.data.organizationId != null &&\n        (belongsToOrganization(request.resource.data.organizationId) ||\n         (getOrganizationId() != '' && getOrganizationId() == request.resource.data.organizationId) ||\n         isOwnerOrAdmin());\n      allow update, delete: if isAuthenticated() && \n        resource.data != null &&\n        resource.data.organizationId != null &&\n        (belongsToOrganization(resource.data.organizationId) ||\n         isOwnerOrAdmin());\n    }\n    match /clipShowAlerts/{alertId} {\n      allow read: if isAuthenticated() && (\n        (hasClipShowProAccess() && getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId) &&\n         (request.auth.uid in resource.data.affectedUsers || isOwnerOrAdmin())) ||\n        (resource.data == null && hasClipShowProAccess() && getOrganizationId() != '')\n      );\n      allow create: if false; \n      allow update: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null &&\n         belongsToOrganization(resource.data.organizationId) &&\n         (request.auth.uid in resource.data.affectedUsers || isOwnerOrAdmin()) &&\n         request.resource.data.diff(resource.data).affectedKeys().hasOnly(['status', 'resolvedAt', 'resolvedBy', 'snoozedUntil', 'updatedAt']))\n      );\n      allow delete: if isAuthenticated() && \n        resource.data != null && \n        resource.data.organizationId != null &&\n        canModifyLicensingData(resource.data.organizationId) && \n        isOwnerOrAdmin();\n    }\n    match /clipShowAIEmbeddings/{embeddingId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null &&\n         belongsToOrganization(resource.data.organizationId)) ||\n        (hasClipShowProAccess() && getOrganizationId() != '')\n      );\n      allow create: if false; \n      allow update: if false; \n      allow delete: if isAuthenticated() && \n        resource.data != null && \n        resource.data.organizationId != null &&\n        canModifyLicensingData(resource.data.organizationId) && \n        isOwnerOrAdmin();\n    }\n    match /clipShowAITrainingData/{trainingId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null &&\n         belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        (hasClipShowProAccess() && getOrganizationId() != '' && isOwnerOrAdmin())\n      );\n      allow create: if false; \n      allow update: if isAuthenticated() && \n        resource.data != null && \n        resource.data.organizationId != null &&\n        canModifyLicensingData(resource.data.organizationId) && \n        isOwnerOrAdmin();\n      allow delete: if isAuthenticated() && \n        resource.data != null && \n        resource.data.organizationId != null &&\n        canModifyLicensingData(resource.data.organizationId) && \n        isOwnerOrAdmin();\n    }\n    match /clipShowAIActionLogs/{logId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null &&\n         belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin()) ||\n        (hasClipShowProAccess() && getOrganizationId() != '' && isOwnerOrAdmin())\n      );\n      allow create: if false; \n      allow update: if false;\n      allow delete: if false;\n    }\n    match /conversations/{conversationId} {\n      allow read: if isAuthenticated() && (\n        (resource.data != null && resource.data.organizationId != null && (\n          belongsToOrganization(resource.data.organizationId) ||\n          (getOrganizationId() != '' && getOrganizationId() == resource.data.organizationId) ||\n          (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() != '' && getOrganizationId() == resource.data.organizationId)\n        )) ||\n        (getOrganizationId() != '' && hasClipShowProAccess())\n      );\n      allow create: if isAuthenticated() &&\n        request.auth.uid in request.resource.data.participants &&\n        belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() &&\n        request.auth.uid in resource.data.participants &&\n        belongsToOrganization(resource.data.organizationId);\n      allow delete: if isAuthenticated() &&\n        request.auth.uid == resource.data.createdBy &&\n        belongsToOrganization(resource.data.organizationId);\n      match /messages/{messageId} {\n        function isParticipant() {\n          let convData = get(/databases/$(database)/documents/conversations/$(conversationId)).data;\n          let participants = convData.get('participants', []);\n          return isAuthenticated() && (\n            isOwnerOrAdmin() ||\n            belongsToOrganization(convData.organizationId) ||\n            (participants is list && request.auth.uid in participants) ||\n            (request.auth.token.email == 'admin.clipshow@example.com' && \n             convData.organizationId == 'clip-show-pro-productions')\n          );\n        }\n        allow read: if isAuthenticated() && isParticipant();\n        allow create: if isAuthenticated() &&\n          isParticipant() &&\n          request.auth.uid == request.resource.data.senderId;\n        allow update: if isAuthenticated() &&\n          (\n            isOwnerOrAdmin() ||\n            request.auth.uid == resource.data.senderId ||\n            (\n              isParticipant() &&\n              request.resource.data.diff(resource.data).affectedKeys().hasAll(['readBy']) &&\n              request.resource.data.conversationId == resource.data.conversationId &&\n              request.resource.data.senderId == resource.data.senderId\n            )\n          );\n        allow delete: if isAuthenticated() &&\n          (request.auth.uid == resource.data.senderId || isOwnerOrAdmin());\n      }\n      match /typingIndicators/{userId} {\n        allow read: if isAuthenticated() &&\n          request.auth.uid in get(/databases/$(database)/documents/conversations/$(conversationId)).data.participants;\n        allow write: if isAuthenticated() &&\n          request.auth.uid == userId &&\n          request.auth.uid in get(/databases/$(database)/documents/conversations/$(conversationId)).data.participants;\n      }\n    }\n    match /organizations/{orgId}/cloudIntegrations/{integrationId} {\n      allow read: if belongsToOrganization(orgId) || \n                   (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions');\n      allow create: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     isAuthenticated();\n      allow update: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     (isOwnerOrAdmin() || request.auth.uid == resource.data.userId);\n      allow delete: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     (isOwnerOrAdmin() || request.auth.uid == resource.data.userId);\n    }\n    match /organizations/{orgId}/indexedFiles/{fileId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create: if belongsToOrganization(orgId) && isAuthenticated();\n      allow update, delete: if belongsToOrganization(orgId) && \n        (isOwnerOrAdmin() || request.auth.uid == resource.data.indexedBy);\n    }\n    match /organizations/{orgId}/dropboxIndexedFiles/{fileId} {\n      allow read: if belongsToOrganizationWithDocCheck(orgId);\n      allow create: if belongsToOrganizationWithDocCheck(orgId) && isAuthenticated();\n      allow update, delete: if belongsToOrganizationWithDocCheck(orgId) && \n        (isOwnerOrAdmin() || request.auth.uid == resource.data.indexedBy);\n    }\n    match /organizations/{orgId}/boxIndexedFiles/{fileId} {\n      allow read: if belongsToOrganizationWithDocCheck(orgId);\n      allow create: if belongsToOrganizationWithDocCheck(orgId) && isAuthenticated();\n      allow update, delete: if belongsToOrganizationWithDocCheck(orgId) && \n        (isOwnerOrAdmin() || request.auth.uid == resource.data.indexedBy);\n    }\n    match /backboneIndexedFiles/{fileId} {\n      allow read: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId))\n      );\n      allow create: if isAuthenticated() && \n        request.resource.data.organizationId != null &&\n        (belongsToOrganization(request.resource.data.organizationId) ||\n         (getOrganizationId() != '' && getOrganizationId() == request.resource.data.organizationId) ||\n         isOwnerOrAdmin());\n      allow update, delete: if isAuthenticated() && \n        resource.data != null && resource.data.organizationId != null &&\n        (belongsToOrganization(resource.data.organizationId) ||\n         (getOrganizationId() != '' && getOrganizationId() == resource.data.organizationId) ||\n         isOwnerOrAdmin() ||\n         request.auth.uid == resource.data.userId);\n    }\n    match /organizations/{orgId}/driveConnections/{connectionId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create, update: if belongsToOrganization(orgId) && \n        isAuthenticated() && \n        request.auth.uid == request.resource.data.userId;\n      allow delete: if belongsToOrganization(orgId) && \n        (isOwnerOrAdmin() || request.auth.uid == resource.data.userId);\n    }\n    match /organizations/{orgId}/boxConnections/{connectionId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create, update: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (request.resource.data.type == 'user' && request.resource.data.userId == request.auth.uid) ||\n          (request.resource.data.type == 'organization' && isOwnerOrAdmin())\n        );\n      allow delete: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (resource.data.type == 'user' && resource.data.userId == request.auth.uid) ||\n          resource.data.connectedBy == request.auth.uid ||\n          isOwnerOrAdmin()\n        );\n    }\n    match /organizations/{orgId}/googleConnections/{connectionId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create, update: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (request.resource.data.type == 'user' && request.resource.data.userId == request.auth.uid) ||\n          (request.resource.data.type == 'organization' && isOwnerOrAdmin())\n        );\n      allow delete: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (resource.data.type == 'user' && resource.data.userId == request.auth.uid) ||\n          resource.data.connectedBy == request.auth.uid ||\n          isOwnerOrAdmin()\n        );\n    }\n    match /organizations/{orgId}/dropboxConnections/{connectionId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create, update: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (request.resource.data.type == 'user' && request.resource.data.userId == request.auth.uid) ||\n          (request.resource.data.type == 'organization' && isOwnerOrAdmin())\n        );\n      allow delete: if belongsToOrganization(orgId) && \n        isAuthenticated() && (\n          (resource.data.type == 'user' && resource.data.userId == request.auth.uid) ||\n          resource.data.connectedBy == request.auth.uid ||\n          isOwnerOrAdmin()\n        );\n    }\n    match /airtableCredentials/{credentialId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId) &&\n                     request.auth.uid == resource.data.userId;\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId) &&\n                       request.auth.uid == request.resource.data.userId;\n      allow update: if isAuthenticated() && \n                       belongsToOrganization(resource.data.organizationId) &&\n                       request.auth.uid == resource.data.userId;\n      allow delete: if isAuthenticated() && \n                       belongsToOrganization(resource.data.organizationId) &&\n                       request.auth.uid == resource.data.userId;\n    }\n    match /airtableIntegrationConfigs/{configId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId) &&\n                       hasRole(['ADMIN', 'OWNER']);\n      allow update, delete: if isAuthenticated() && \n                               belongsToOrganization(resource.data.organizationId) &&\n                               hasRole(['ADMIN', 'OWNER']);\n    }\n    match /airtableSyncStatus/{configId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if isAuthenticated() && \n                     belongsToOrganization(request.resource.data.organizationId) &&\n                     (isOwnerOrAdmin() || hasAnyRole(['ADMIN', 'OWNER']));\n    }\n    match /airtableSyncHistory/{historyId} {\n      allow read: if isAuthenticated() && (\n        (hasClipShowProAccess() && getOrganizationId() != '') ||\n        (resource.data != null && resource.data.organizationId != null && belongsToOrganization(resource.data.organizationId))\n      );\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId);\n      allow update, delete: if isAuthenticated() && \n                               belongsToOrganization(resource.data.organizationId) &&\n                               (isOwnerOrAdmin() || request.auth.uid == resource.data.userId);\n    }\n    match /airtableSyncMetadata/{metadataId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if false; \n    }\n    match /airtableSyncQueue/{queueId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId);\n      allow update, delete: if false; \n    }\n    match /airtableSyncBatches/{batchId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if false; \n    }\n    match /airtableFieldMappings/{mappingId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId) &&\n                       hasRole(['ADMIN', 'OWNER']);\n      allow update, delete: if isAuthenticated() && \n                               belongsToOrganization(resource.data.organizationId) &&\n                               hasRole(['ADMIN', 'OWNER']);\n    }\n    match /airtableWebhookQueue/{queueId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if false; \n    }\n    match /airtableBackups/{backupId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if false; \n    }\n    match /airtableAuditLog/{logId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId) &&\n                     hasRole(['ADMIN', 'OWNER']);\n      allow write: if false; \n    }\n    match /airtableAccessControl/{ruleId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId) &&\n                     hasRole(['ADMIN', 'OWNER']);\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId) &&\n                       hasRole(['ADMIN', 'OWNER']);\n      allow update, delete: if isAuthenticated() && \n                               belongsToOrganization(resource.data.organizationId) &&\n                               hasRole(['ADMIN', 'OWNER']);\n    }\n    match /airtableValidationReports/{reportId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow write: if false; \n    }\n    match /airtableMigrationHistory/{historyId} {\n      allow read: if isAuthenticated() && \n                     belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() && \n                       belongsToOrganization(request.resource.data.organizationId);\n      allow update, delete: if false; \n    }\n    match /organizations/{orgId}/integrationConfigs/{configId} {\n      allow read: if belongsToOrganization(orgId) || \n                   (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions');\n      allow create: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     isAuthenticated();\n      allow update: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     isAuthenticated();\n      allow delete: if (belongsToOrganization(orgId) || \n                        (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                     isAuthenticated();\n    }\n    match /organizations/{orgId}/scriptTemplates/{templateId} {\n      allow read: if belongsToOrganization(orgId) || resource.data.isPublic == true;\n      allow create: if belongsToOrganization(orgId) && isAuthenticated();\n      allow update: if belongsToOrganization(orgId) && (\n        isOwnerOrAdmin() || \n        request.auth.uid == resource.data.createdBy\n      );\n      allow delete: if belongsToOrganization(orgId) && (\n        isOwnerOrAdmin() || \n        request.auth.uid == resource.data.createdBy\n      );\n    }\n    match /organizations/{orgId}/emailSettings/{settingsId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n      allow update: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n      allow delete: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n    }\n    match /organizations/{orgId}/integrationSettings/{integrationId} {\n      allow read: if (belongsToOrganization(orgId) || \n                       (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                    isOwnerOrAdmin();\n      allow create: if (belongsToOrganization(orgId) || \n                         (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                      isOwnerOrAdmin();\n      allow update: if (belongsToOrganization(orgId) || \n                         (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                      isOwnerOrAdmin();\n      allow delete: if (belongsToOrganization(orgId) || \n                         (request.auth.token.email == 'admin.clipshow@example.com' && orgId == 'clip-show-pro-productions')) && \n                      isOwnerOrAdmin();\n    }\n    match /organizations/{orgId}/emailNotificationLogs/{logId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create: if true; \n      allow update: if false; \n      allow delete: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n    }\n    match /automationFunctions/{functionId} {\n      allow read: if isAuthenticated();\n      allow write: if false; \n    }\n    match /automationRules/{ruleId} {\n      allow read: if isAuthenticated() && belongsToOrganization(resource.data.organizationId);\n      allow create: if isAuthenticated() && isOwnerOrAdmin() && belongsToOrganization(request.resource.data.organizationId);\n      allow update: if isAuthenticated() && isOwnerOrAdmin() && belongsToOrganization(resource.data.organizationId);\n      allow delete: if isAuthenticated() && isOwnerOrAdmin() && belongsToOrganization(resource.data.organizationId);\n    }\n    match /automationLogs/{logId} {\n      allow read: if isAuthenticated() && belongsToOrganization(resource.data.organizationId);\n      allow create: if true; \n      allow update: if false; \n      allow delete: if isAuthenticated() && isOwnerOrAdmin() && belongsToOrganization(resource.data.organizationId);\n    }\n    match /pageInfo/{pageId} {\n      allow read: if true; \n      allow write: if isAuthenticated() && isOwnerOrAdmin();\n    }\n    match /userPagePermissions/{permissionId} {\n      allow read: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(resource.data.organizationId) && (\n          request.auth.uid == resource.data.userId ||\n          getOrganizationId() == resource.data.organizationId\n        )\n      );\n      allow create, update: if isAuthenticated() && (\n        isOwnerOrAdmin() && belongsToOrganization(request.resource.data.organizationId)\n      );\n      allow delete: if isAuthenticated() && isOwnerOrAdmin();\n    }\n    match /organizations/{orgId}/slackConnections/{connectionId} {\n      allow read: if isAuthenticated() && belongsToOrganization(orgId);\n      allow create, update: if isAuthenticated() && belongsToOrganization(orgId) && (\n        isOwnerOrAdmin() ||\n        request.resource.data.type == 'user' && request.auth.uid == request.resource.data.userId\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(orgId) && (\n        isOwnerOrAdmin() ||\n        resource.data.type == 'user' && request.auth.uid == resource.data.userId\n      );\n    }\n    match /organizations/{orgId}/slackChannels/{channelId} {\n      allow read: if isAuthenticated() && belongsToOrganization(orgId);\n      allow create, update: if isAuthenticated() && belongsToOrganization(orgId) && (\n        isOwnerOrAdmin() ||\n        request.auth.uid == request.resource.data.userId\n      );\n      allow delete: if isAuthenticated() && belongsToOrganization(orgId) && isOwnerOrAdmin();\n      match /messages/{messageId} {\n        allow read: if isAuthenticated() && belongsToOrganization(orgId);\n        allow create, update: if isAuthenticated() && belongsToOrganization(orgId);\n        allow delete: if isAuthenticated() && belongsToOrganization(orgId) && isOwnerOrAdmin();\n      }\n    }\n    match /organizations/{orgId}/slackUsers/{userId} {\n      allow read: if isAuthenticated() && belongsToOrganization(orgId);\n      allow create, update: if isAuthenticated() && belongsToOrganization(orgId);\n      allow delete: if isAuthenticated() && belongsToOrganization(orgId) && isOwnerOrAdmin();\n    }\n    match /transcriptionTasks/{taskId} {\n      allow read: if isAuthenticated() && (\n        resource.data.userId == request.auth.uid ||\n        belongsToOrganization(resource.data.organizationId)\n      );\n      allow create: if isAuthenticated() && (\n        request.resource.data.userId == request.auth.uid &&\n        belongsToOrganization(request.resource.data.organizationId)\n      );\n      allow update: if false; \n      allow delete: if isAuthenticated() && (\n        resource.data.userId == request.auth.uid ||\n        (belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin())\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/templates/{templateDocId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/grouped-clips/{groupId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/indexed-files/{indexedFilesDocId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/file-metadata/{fileId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/edl-files/{fileId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/edl-events/{eventId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/budget-values/{docId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/budget-groups/{docId} {\n      allow read, write: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/budget-calculations/{docId} {\n      allow read, write: if isAuthenticated() && (\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        (isLicensingSpecialist() && hasClipShowProAccess() && getOrganizationId() == orgId)\n      );\n    }\n    match /organizations/{orgId}/projects/{projectId}/cue-sheets/{cueSheetId} {\n      allow read: if isAuthenticated() && (\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        (hasClipShowProAccess() && belongsToOrganization(orgId)) ||\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        getOrganizationId() == 'standalone' ||\n        (belongsToOrganization(orgId) && \n         canVerifyBlockchain() &&\n         request.resource.data.diff(resource.data).affectedKeys().hasOnly(['blockchainMetadata', 'productionInfo', 'updatedAt', 'metadata']))\n      );\n      allow delete: if isAuthenticated() && (\n        isOwnerOrAdmin() ||\n        belongsToOrganization(orgId) ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /collaboration/{roomId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /organizations/{orgId}/aiApiKeys/{serviceId} {\n      allow read: if belongsToOrganization(orgId);\n      allow create: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n      allow update: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n      allow delete: if belongsToOrganization(orgId) && isOwnerOrAdmin();\n    }\n    match /users/{userId}/aiApiKeys/{serviceId} {\n      allow read: if isAuthenticated() && request.auth.uid == userId;\n      allow create: if isAuthenticated() && request.auth.uid == userId;\n      allow update: if isAuthenticated() && request.auth.uid == userId;\n      allow delete: if isAuthenticated() && request.auth.uid == userId;\n    }\n    match /aiChatHistory/{userId} {\n      allow read, write: if isAuthenticated() && request.auth.uid == userId;\n      match /messages/{messageId} {\n        allow read: if isAuthenticated() && request.auth.uid == userId;\n        allow create: if isAuthenticated() && request.auth.uid == userId;\n        allow update, delete: if false;\n      }\n      match /savedChats/{chatId} {\n        allow read: if isAuthenticated() && request.auth.uid == userId;\n        allow create: if isAuthenticated() && request.auth.uid == userId;\n        allow update: if isAuthenticated() && request.auth.uid == userId;\n        allow delete: if isAuthenticated() && request.auth.uid == userId;\n      }\n    }\n    match /tenants/{orgId} {\n      function belongsToTenantOrg() {\n        return belongsToOrganization(orgId) || isOwnerOrAdmin();\n      }\n      match /projects/{projectId} {\n        allow read: if belongsToTenantOrg();\n        allow create: if belongsToTenantOrg();\n        allow update: if belongsToTenantOrg() && (\n          canModifyProject(projectId) ||\n          isOwnerOrAdmin()\n        );\n        allow delete: if belongsToTenantOrg() && isOwnerOrAdmin();\n      }\n      match /projectTeamMembers/{assignmentId} {\n        allow read: if belongsToTenantOrg();\n        allow create: if belongsToTenantOrg();\n        allow update: if belongsToTenantOrg() && (\n          (resource.data.projectId != null && canModifyProject(resource.data.projectId)) ||\n          isOwnerOrAdmin()\n        );\n        allow delete: if belongsToTenantOrg() && isOwnerOrAdmin();\n      }\n      match /project_participants/{participantId} {\n        allow read: if belongsToTenantOrg();\n        allow create: if belongsToTenantOrg();\n        allow update: if belongsToTenantOrg();\n        allow delete: if belongsToTenantOrg() && isOwnerOrAdmin();\n      }\n      match /datasets/{datasetId} {\n        allow read: if belongsToTenantOrg();\n        allow create: if belongsToTenantOrg();\n        allow update: if belongsToTenantOrg();\n        allow delete: if belongsToTenantOrg() && isOwnerOrAdmin();\n      }\n    }\n    match /workflowTemplates/{templateId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/workflowTemplates/{templateId} {\n      allow read: if isAuthenticated();\n    }\n    match /workflowInstances/{instanceId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated() && (\n        // ENFORCE: Workflows must have a sessionId\n        request.resource.data.sessionId is string &&\n        request.resource.data.sessionId.size() > 0\n      );\n      allow update: if isAuthenticated() && (\n        // ENFORCE: Cannot remove sessionId\n        request.resource.data.sessionId is string &&\n        request.resource.data.sessionId.size() > 0\n      );\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/workflowInstances/{instanceId} {\n      allow read: if isAuthenticated();\n    }\n    match /workflowSteps/{stepId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      ) && (\n        // ENFORCE: Steps must have a workflowInstanceId\n        request.resource.data.workflowInstanceId is string &&\n        request.resource.data.workflowInstanceId.size() > 0\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      ) && (\n        // ENFORCE: Cannot remove workflowInstanceId\n        request.resource.data.workflowInstanceId is string &&\n        request.resource.data.workflowInstanceId.size() > 0\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/workflowSteps/{stepId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /workflow-templates/{templateId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /workflow-instances/{instanceId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /savedContainers/{containerId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/savedContainers/{containerId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /reviewSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/reviewSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /reviewSessionReviewers/{reviewerId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/reviewSessionReviewers/{reviewerId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /postProductionTasks/{taskId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/postProductionTasks/{taskId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /deliverables/{deliverableId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/deliverables/{deliverableId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /sessionAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/sessionAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /workflows/{workflowId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/workflows/{workflowId} {\n      allow read: if isAuthenticated();\n    }\n    match /contacts/{contactId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/contacts/{contactId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /inventory/{inventoryId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/inventory/{inventoryId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /userPreferences/{userId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && request.auth.uid == userId;\n      allow update: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/userPreferences/{userId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /assignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/assignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /sessionWorkflows/{workflowId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/sessionWorkflows/{workflowId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /user-workflows/{workflowId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/user-workflows/{workflowId} {\n      allow read: if isAuthenticated();\n    }\n    match /unifiedSessionSteps/{stepId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/unifiedSessionSteps/{stepId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /userDirectReports/{reportId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/userDirectReports/{reportId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /directReports/{reportId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/directReports/{reportId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /organizationMembers/{memberId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/organizationMembers/{memberId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /organizationSettings/{settingId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/organizationSettings/{settingId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /health-check/{checkId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /success/{statusId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /warning/{warningId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /brainMemory/{memoryId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/brainMemory/{memoryId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /brainSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/brainSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /broadcasts/{broadcastId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/broadcasts/{broadcastId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /broadcast_viewers/{viewerId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/broadcast_viewers/{viewerId} {\n      allow read: if isAuthenticated();\n    }\n    match /chat/{chatId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/chat/{chatId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /edlStandaloneUsers/{userId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/edlStandaloneUsers/{userId} {\n      allow read: if isAuthenticated();\n    }\n    match /edlWorkspaces/{workspaceId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/edlWorkspaces/{workspaceId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /automationExecutions/{executionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/automationExecutions/{executionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /sessionAutomations/{automationId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/sessionAutomations/{automationId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /scheduledActions/{actionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/scheduledActions/{actionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /qcSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/qcSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /reviewFilePaths/{pathId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/reviewFilePaths/{pathId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /roles/{roleId} {\n      allow read: if isAuthenticated();\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/roles/{roleId} {\n      allow read: if isAuthenticated();\n    }\n    match /securityAuditLogs/{logId} {\n      allow read: if isOwnerOrAdmin();\n      allow create: if isAuthenticated();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/securityAuditLogs/{logId} {\n      allow read: if isOwnerOrAdmin();\n    }\n    match /sessionTracking/{trackingId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/sessionTracking/{trackingId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /tracking/{trackingId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/tracking/{trackingId} {\n      allow read: if isAuthenticated();\n    }\n    match /standaloneUsers/{userId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        request.auth.uid == userId ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/standaloneUsers/{userId} {\n      allow read: if isAuthenticated();\n    }\n    match /org_members/{memberId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/org_members/{memberId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /portfolios/{portfolioId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/portfolios/{portfolioId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /pbmAnalytics/{analyticsId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/pbmAnalytics/{analyticsId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /lifecycleRules/{ruleId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isOwnerOrAdmin();\n      allow update: if isOwnerOrAdmin();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /{path=**}/lifecycleRules/{ruleId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /webrtc_signals/{signalId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isAuthenticated();\n    }\n    match /{path=**}/webrtc_signals/{signalId} {\n      allow read: if isAuthenticated();\n    }\n    match /inventoryAssignmentHistory/{historyId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/inventoryAssignmentHistory/{historyId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /inventoryHistory/{historyId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/inventoryHistory/{historyId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /networkIPRanges/{rangeId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/networkIPRanges/{rangeId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /networks/{networkId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/networks/{networkId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /schemas/{schemaId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/schemas/{schemaId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /callSheetTemplates/{templateId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/callSheetTemplates/{templateId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /dailyRecords/{recordId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/dailyRecords/{recordId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /oauthStates/{stateId} {\n      allow read: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        request.auth.uid == resource.data.userId ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/oauthStates/{stateId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.userId != null && \n         request.auth.uid == resource.data.userId) ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /budgetValues/{valueId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /budgets/{budgetId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /checkoutRecords/{recordId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipPitches/{pitchId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /clipShowCalendarEvents/{eventId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /cue-sheets/{sheetId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /cueSheets/{sheetId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /licenseAgreements/{agreementId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /locations/{locationId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /musicFiles/{fileId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /networkDevices/{deviceId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /pattern-conflicts/{conflictId} {\n      allow read: if isAuthenticated();\n      allow create: if isAuthenticated();\n      allow update: if isAuthenticated();\n      allow delete: if isOwnerOrAdmin();\n    }\n    match /projectSessions/{sessionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /scenes/{sceneId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /slackConnections/{connectionId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /networkDeliveryBibles/{bibleId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      \n      // Deliverables subcollection\n      match /deliverables/{deliverableId} {\n        allow read: if isAuthenticated() && (\n          belongsToOrganization(get(/databases/$(database)/documents/networkDeliveryBibles/$(bibleId)).data.organizationId) ||\n          getOrganizationId() == 'standalone'\n        );\n        allow create: if isAuthenticated() && (\n          belongsToOrganization(get(/databases/$(database)/documents/networkDeliveryBibles/$(bibleId)).data.organizationId) ||\n          getOrganizationId() == 'standalone'\n        );\n        allow update: if isAuthenticated() && (\n          belongsToOrganization(get(/databases/$(database)/documents/networkDeliveryBibles/$(bibleId)).data.organizationId) ||\n          getOrganizationId() == 'standalone'\n        );\n        allow delete: if isAuthenticated() && (\n          belongsToOrganization(get(/databases/$(database)/documents/networkDeliveryBibles/$(bibleId)).data.organizationId) ||\n          getOrganizationId() == 'standalone'\n        );\n      }\n    }\n    match /{path=**}/networkDeliveryBibles/{bibleId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /inventorySchemas/{schemaId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) && isOwnerOrAdmin() ||\n        getOrganizationId() == 'standalone'\n      );\n    }\n    match /{path=**}/inventorySchemas/{schemaId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /networkIPAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow create: if isAuthenticated() && (\n        belongsToOrganization(request.resource.data.organizationId) ||\n        getOrganizationId() == 'standalone'\n      );\n      allow update: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n      allow delete: if isAuthenticated() && (\n        belongsToOrganization(resource.data.organizationId) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{path=**}/networkIPAssignments/{assignmentId} {\n      allow read: if isAuthenticated() && (\n        (resource != null && resource.data != null && resource.data.organizationId != null && \n         belongsToOrganization(resource.data.organizationId)) ||\n        getOrganizationId() == 'standalone' ||\n        isOwnerOrAdmin()\n      );\n    }\n    match /{document=**} {\n      allow read, write: if false;\n    }\n\n    // AUTO-SYNCED COLLECTIONS\n    match /steps/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/steps/{docId} { allow read: if request.auth != null; }\n    match /customSchemas/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/customSchemas/{docId} { allow read: if request.auth != null; }\n    match /integrationConfigs/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/integrationConfigs/{docId} { allow read: if request.auth != null; }\n    match /slackChannels/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/slackChannels/{docId} { allow read: if request.auth != null; }\n    match /integrations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/integrations/{docId} { allow read: if request.auth != null; }\n    match /team_members/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/team_members/{docId} { allow read: if request.auth != null; }\n    match /networkDeliveryDeliverables/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/networkDeliveryDeliverables/{docId} { allow read: if request.auth != null; }\n    match /workflowDiagrams/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflowDiagrams/{docId} { allow read: if request.auth != null; }\n    match /user_settingss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_settingss/{docId} { allow read: if request.auth != null; }\n    match /custom_roles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/custom_roles/{docId} { allow read: if request.auth != null; }\n    match /workflow_diagrams/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_diagrams/{docId} { allow read: if request.auth != null; }\n    match /user_groups/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_groups/{docId} { allow read: if request.auth != null; }\n    match /user_group_memberships/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_group_memberships/{docId} { allow read: if request.auth != null; }\n    match /stages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/stages/{docId} { allow read: if request.auth != null; }\n    match /session_roles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_roles/{docId} { allow read: if request.auth != null; }\n    match /production_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_sessions/{docId} { allow read: if request.auth != null; }\n    match /production_stages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_stages/{docId} { allow read: if request.auth != null; }\n    match /production_tasks/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_tasks/{docId} { allow read: if request.auth != null; }\n    match /production_task_assignees/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_assignees/{docId} { allow read: if request.auth != null; }\n    match /production_crew_members/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_crew_members/{docId} { allow read: if request.auth != null; }\n    match /production_workflow_correlations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_workflow_correlations/{docId} { allow read: if request.auth != null; }\n    match /session_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_assignments/{docId} { allow read: if request.auth != null; }\n    match /unified_workflow_instances/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/unified_workflow_instances/{docId} { allow read: if request.auth != null; }\n    match /unified_session_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/unified_session_assignments/{docId} { allow read: if request.auth != null; }\n    match /unified_session_steps/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/unified_session_steps/{docId} { allow read: if request.auth != null; }\n    match /file_checklists/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/file_checklists/{docId} { allow read: if request.auth != null; }\n    match /post_production_stages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/post_production_stages/{docId} { allow read: if request.auth != null; }\n    match /post_production_tasks/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/post_production_tasks/{docId} { allow read: if request.auth != null; }\n    match /task_assignees/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/task_assignees/{docId} { allow read: if request.auth != null; }\n    match /review_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_sessions/{docId} { allow read: if request.auth != null; }\n    match /review_notes/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_notes/{docId} { allow read: if request.auth != null; }\n    match /review_approvals/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_approvals/{docId} { allow read: if request.auth != null; }\n    match /review_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_assignments/{docId} { allow read: if request.auth != null; }\n    match /review_session_reviewers/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_session_reviewers/{docId} { allow read: if request.auth != null; }\n    match /review_sections/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_sections/{docId} { allow read: if request.auth != null; }\n    match /cut_approvals/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/cut_approvals/{docId} { allow read: if request.auth != null; }\n    match /cut_types/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/cut_types/{docId} { allow read: if request.auth != null; }\n    match /assets/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/assets/{docId} { allow read: if request.auth != null; }\n    match /r_w_a_detailss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/r_w_a_detailss/{docId} { allow read: if request.auth != null; }\n    match /rwa_documents/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/rwa_documents/{docId} { allow read: if request.auth != null; }\n    match /tax_lots/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/tax_lots/{docId} { allow read: if request.auth != null; }\n    match /asset_performances/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/asset_performances/{docId} { allow read: if request.auth != null; }\n    match /asset_price_historys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/asset_price_historys/{docId} { allow read: if request.auth != null; }\n    match /portfolio_performances/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/portfolio_performances/{docId} { allow read: if request.auth != null; }\n    match /portfolio_tax_summarys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/portfolio_tax_summarys/{docId} { allow read: if request.auth != null; }\n    match /portfolio_allocations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/portfolio_allocations/{docId} { allow read: if request.auth != null; }\n    match /transactions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/transactions/{docId} { allow read: if request.auth != null; }\n    match /invoice_items/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/invoice_items/{docId} { allow read: if request.auth != null; }\n    match /invoice_payments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/invoice_payments/{docId} { allow read: if request.auth != null; }\n    match /invoice_attachments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/invoice_attachments/{docId} { allow read: if request.auth != null; }\n    match /contact_groups/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/contact_groups/{docId} { allow read: if request.auth != null; }\n    match /contact_group_memberships/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/contact_group_memberships/{docId} { allow read: if request.auth != null; }\n    match /chats/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/chats/{docId} { allow read: if request.auth != null; }\n    match /chat_participants/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/chat_participants/{docId} { allow read: if request.auth != null; }\n    match /message_reads/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/message_reads/{docId} { allow read: if request.auth != null; }\n    match /agents/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/agents/{docId} { allow read: if request.auth != null; }\n    match /agent_memorys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/agent_memorys/{docId} { allow read: if request.auth != null; }\n    match /agent_function_logs/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/agent_function_logs/{docId} { allow read: if request.auth != null; }\n    match /research_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/research_sessions/{docId} { allow read: if request.auth != null; }\n    match /scheduler_events/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/scheduler_events/{docId} { allow read: if request.auth != null; }\n    match /scheduler_event_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/scheduler_event_assignments/{docId} { allow read: if request.auth != null; }\n    match /scheduler_tasks/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/scheduler_tasks/{docId} { allow read: if request.auth != null; }\n    match /test_models/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/test_models/{docId} { allow read: if request.auth != null; }\n    match /message_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/message_sessions/{docId} { allow read: if request.auth != null; }\n    match /message_participants/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/message_participants/{docId} { allow read: if request.auth != null; }\n    match /session_messages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_messages/{docId} { allow read: if request.auth != null; }\n    match /session_message_reads/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_message_reads/{docId} { allow read: if request.auth != null; }\n    match /inventory_items/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/inventory_items/{docId} { allow read: if request.auth != null; }\n    match /schema_fields/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/schema_fields/{docId} { allow read: if request.auth != null; }\n    match /network_i_p_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/network_i_p_assignments/{docId} { allow read: if request.auth != null; }\n    match /inventory_historys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/inventory_historys/{docId} { allow read: if request.auth != null; }\n    match /inventory_assignment_historys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/inventory_assignment_historys/{docId} { allow read: if request.auth != null; }\n    match /servers/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/servers/{docId} { allow read: if request.auth != null; }\n    match /asset_setups/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/asset_setups/{docId} { allow read: if request.auth != null; }\n    match /setup_profiles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/setup_profiles/{docId} { allow read: if request.auth != null; }\n    match /setup_checklists/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/setup_checklists/{docId} { allow read: if request.auth != null; }\n    match /asset_setup_checklists/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/asset_setup_checklists/{docId} { allow read: if request.auth != null; }\n    match /chapter_markers/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/chapter_markers/{docId} { allow read: if request.auth != null; }\n    match /qc_statuss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_statuss/{docId} { allow read: if request.auth != null; }\n    match /qc_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_sessions/{docId} { allow read: if request.auth != null; }\n    match /qc_checklist_items/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_checklist_items/{docId} { allow read: if request.auth != null; }\n    match /qc_findings/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_findings/{docId} { allow read: if request.auth != null; }\n    match /qc_reports/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_reports/{docId} { allow read: if request.auth != null; }\n    match /qc_activitys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/qc_activitys/{docId} { allow read: if request.auth != null; }\n    match /session_archives/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_archives/{docId} { allow read: if request.auth != null; }\n    match /session_files/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_files/{docId} { allow read: if request.auth != null; }\n    match /task_notifications/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/task_notifications/{docId} { allow read: if request.auth != null; }\n    match /network_i_p_ranges/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/network_i_p_ranges/{docId} { allow read: if request.auth != null; }\n    match /pod_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/pod_assignments/{docId} { allow read: if request.auth != null; }\n    match /system_assets/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/system_assets/{docId} { allow read: if request.auth != null; }\n    match /tenant_storage_usages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/tenant_storage_usages/{docId} { allow read: if request.auth != null; }\n    match /inventory_maps/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/inventory_maps/{docId} { allow read: if request.auth != null; }\n    match /map_datas/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/map_datas/{docId} { allow read: if request.auth != null; }\n    match /map_layouts/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/map_layouts/{docId} { allow read: if request.auth != null; }\n    match /map_locations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/map_locations/{docId} { allow read: if request.auth != null; }\n    match /command_center_layouts/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/command_center_layouts/{docId} { allow read: if request.auth != null; }\n    match /slack_integrations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/slack_integrations/{docId} { allow read: if request.auth != null; }\n    match /workflow_steps/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_steps/{docId} { allow read: if request.auth != null; }\n    match /workflow_dependencys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_dependencys/{docId} { allow read: if request.auth != null; }\n    match /workflow_triggers/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_triggers/{docId} { allow read: if request.auth != null; }\n    match /session_workflows/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_workflows/{docId} { allow read: if request.auth != null; }\n    match /workflow_notifications/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_notifications/{docId} { allow read: if request.auth != null; }\n    match /workflow_activitys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_activitys/{docId} { allow read: if request.auth != null; }\n    match /session_workflow_task_integrations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_workflow_task_integrations/{docId} { allow read: if request.auth != null; }\n    match /post_production_workflow_correlations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/post_production_workflow_correlations/{docId} { allow read: if request.auth != null; }\n    match /teams/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/teams/{docId} { allow read: if request.auth != null; }\n    match /session_stepss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_stepss/{docId} { allow read: if request.auth != null; }\n    match /unified_step_progressions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/unified_step_progressions/{docId} { allow read: if request.auth != null; }\n    match /unified_step_events/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/unified_step_events/{docId} { allow read: if request.auth != null; }\n    match /session_elements/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_elements/{docId} { allow read: if request.auth != null; }\n    match /element_activitys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/element_activitys/{docId} { allow read: if request.auth != null; }\n    match /element_reviews/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/element_reviews/{docId} { allow read: if request.auth != null; }\n    match /element_files/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/element_files/{docId} { allow read: if request.auth != null; }\n    match /element_dependencys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/element_dependencys/{docId} { allow read: if request.auth != null; }\n    match /media_file_tags/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/media_file_tags/{docId} { allow read: if request.auth != null; }\n    match /media_files/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/media_files/{docId} { allow read: if request.auth != null; }\n    match /review_file_paths/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/review_file_paths/{docId} { allow read: if request.auth != null; }\n    match /media_indexs/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/media_indexs/{docId} { allow read: if request.auth != null; }\n    match /media_index_items/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/media_index_items/{docId} { allow read: if request.auth != null; }\n    match /production_session_to_projects/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_session_to_projects/{docId} { allow read: if request.auth != null; }\n    match /production_session_to_stages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_session_to_stages/{docId} { allow read: if request.auth != null; }\n    match /production_session_to_users/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_session_to_users/{docId} { allow read: if request.auth != null; }\n    match /production_session_archived_by_to_users/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_session_archived_by_to_users/{docId} { allow read: if request.auth != null; }\n    match /production_task_assigned_to_users/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_assigned_to_users/{docId} { allow read: if request.auth != null; }\n    match /production_task_created_bys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_created_bys/{docId} { allow read: if request.auth != null; }\n    match /production_task_last_updated_bys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_last_updated_bys/{docId} { allow read: if request.auth != null; }\n    match /production_task_to_roles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_to_roles/{docId} { allow read: if request.auth != null; }\n    match /production_task_to_session_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_task_to_session_assignments/{docId} { allow read: if request.auth != null; }\n    match /session_on_hold_bys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_on_hold_bys/{docId} { allow read: if request.auth != null; }\n    match /ebsocket_serverss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/ebsocket_serverss/{docId} { allow read: if request.auth != null; }\n    match /ebsocket_sessionss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/ebsocket_sessionss/{docId} { allow read: if request.auth != null; }\n    match /automation_alert_acknowledgments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/automation_alert_acknowledgments/{docId} { allow read: if request.auth != null; }\n    match /lifecycle_rules/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/lifecycle_rules/{docId} { allow read: if request.auth != null; }\n    match /automation_executions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/automation_executions/{docId} { allow read: if request.auth != null; }\n    match /session_phase_transitions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_phase_transitions/{docId} { allow read: if request.auth != null; }\n    match /session_lifecycle_states/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/session_lifecycle_states/{docId} { allow read: if request.auth != null; }\n    match /user_time_cards/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_time_cards/{docId} { allow read: if request.auth != null; }\n    match /user_timecard_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_timecard_assignments/{docId} { allow read: if request.auth != null; }\n    match /timecard_configurations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/timecard_configurations/{docId} { allow read: if request.auth != null; }\n    match /user_direct_reports/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_direct_reports/{docId} { allow read: if request.auth != null; }\n    match /timecard_approval_flows/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/timecard_approval_flows/{docId} { allow read: if request.auth != null; }\n    match /timecard_assistance_dismissals/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/timecard_assistance_dismissals/{docId} { allow read: if request.auth != null; }\n    match /workflow_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/workflow_assignments/{docId} { allow read: if request.auth != null; }\n    match /call_sheets/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheets/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_records/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_records/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_locations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_locations/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_personnels/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_personnels/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_department_call_times/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_department_call_times/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_schedules/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_schedules/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_vendors/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_vendors/{docId} { allow read: if request.auth != null; }\n    match /daily_call_sheet_walkie_channels/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/daily_call_sheet_walkie_channels/{docId} { allow read: if request.auth != null; }\n    match /production_departments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_departments/{docId} { allow read: if request.auth != null; }\n    match /production_sub_departments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_sub_departments/{docId} { allow read: if request.auth != null; }\n    match /production_roles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/production_roles/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_locations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_locations/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_personnels/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_personnels/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_department_call_times/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_department_call_times/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_schedules/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_schedules/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_vendors/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_vendors/{docId} { allow read: if request.auth != null; }\n    match /call_sheet_walkie_channels/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/call_sheet_walkie_channels/{docId} { allow read: if request.auth != null; }\n    match /p_b_m_projects/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/p_b_m_projects/{docId} { allow read: if request.auth != null; }\n    match /p_b_m_schedules/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/p_b_m_schedules/{docId} { allow read: if request.auth != null; }\n    match /p_b_m_payscales/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/p_b_m_payscales/{docId} { allow read: if request.auth != null; }\n    match /p_b_m_daily_statuss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/p_b_m_daily_statuss/{docId} { allow read: if request.auth != null; }\n    match /brain_chat_sessions/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/brain_chat_sessions/{docId} { allow read: if request.auth != null; }\n    match /brain_chat_messages/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/brain_chat_messages/{docId} { allow read: if request.auth != null; }\n    match /saved_project_paths/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/saved_project_paths/{docId} { allow read: if request.auth != null; }\n    match /user_memory_profiles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/user_memory_profiles/{docId} { allow read: if request.auth != null; }\n    match /conversation_patterns/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/conversation_patterns/{docId} { allow read: if request.auth != null; }\n    match /domain_knowledges/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/domain_knowledges/{docId} { allow read: if request.auth != null; }\n    match /relationship_anchors/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/relationship_anchors/{docId} { allow read: if request.auth != null; }\n    match /memory_slots/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/memory_slots/{docId} { allow read: if request.auth != null; }\n    match /memory_system_metricss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/memory_system_metricss/{docId} { allow read: if request.auth != null; }\n    match /collaboration_invitations/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/collaboration_invitations/{docId} { allow read: if request.auth != null; }\n    match /project_collaboration_settingss/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/project_collaboration_settingss/{docId} { allow read: if request.auth != null; }\n    match /project_activitys/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/project_activitys/{docId} { allow read: if request.auth != null; }\n    match /real_time_presences/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/real_time_presences/{docId} { allow read: if request.auth != null; }\n    match /dropboxIndexedFiles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/dropboxIndexedFiles/{docId} { allow read: if request.auth != null; }\n    match /boxIndexedFiles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/boxIndexedFiles/{docId} { allow read: if request.auth != null; }\n    match /indexedFiles/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/indexedFiles/{docId} { allow read: if request.auth != null; }\n    match /timecard_assignments/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/timecard_assignments/{docId} { allow read: if request.auth != null; }\n    match /timecardApprovals/{docId} { allow read, write: if request.auth != null; }\n    match /{path=**}/timecardApprovals/{docId} { allow read: if request.auth != null; }\n\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-12-29T07:51:44.195855Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-12-29T07:51:44.304Z] [rules] created ruleset projects/backbone-logic/rulesets/c69dfbd8-6a6c-4373-9408-ca7092e28385
[debug] [2025-12-29T07:51:44.304Z] [rules] releasing cloud.firestore/(default) with ruleset projects/backbone-logic/rulesets/c69dfbd8-6a6c-4373-9408-ca7092e28385
[debug] [2025-12-29T07:51:44.304Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:44.305Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:44.305Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases/cloud.firestore/(default) [none]
[debug] [2025-12-29T07:51:44.305Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases/cloud.firestore/(default) {"release":{"name":"projects/backbone-logic/releases/cloud.firestore/(default)","rulesetName":"projects/backbone-logic/rulesets/c69dfbd8-6a6c-4373-9408-ca7092e28385"}}
[debug] [2025-12-29T07:51:45.670Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases/cloud.firestore/(default) 400
[debug] [2025-12-29T07:51:45.670Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases/cloud.firestore/(default) {"error":{"code":400,"message":"Request contains an invalid argument.","status":"INVALID_ARGUMENT"}}
[debug] [2025-12-29T07:51:45.671Z] [rules] ruleset update failed, attempting to create instead
[debug] [2025-12-29T07:51:45.671Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:45.671Z] Checked if tokens are valid: true, expires at: 1766997606209
[debug] [2025-12-29T07:51:45.671Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases [none]
[debug] [2025-12-29T07:51:45.671Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases {"name":"projects/backbone-logic/releases/cloud.firestore/(default)","rulesetName":"projects/backbone-logic/rulesets/c69dfbd8-6a6c-4373-9408-ca7092e28385"}
[debug] [2025-12-29T07:51:46.019Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases 409
[debug] [2025-12-29T07:51:46.019Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases {"error":{"code":409,"message":"Requested entity already exists","status":"ALREADY_EXISTS"}}
[error] 
[error] Error: Request to https://firebaserules.googleapis.com/v1/projects/backbone-logic/releases had HTTP Error: 409, Requested entity already exists
[debug] [2025-12-29T07:51:46.020Z] Error Context: {
  "body": {
    "error": {
      "code": 409,
      "message": "Requested entity already exists",
      "status": "ALREADY_EXISTS"
    }
  },
  "response": {
    "statusCode": 409
  }
}
